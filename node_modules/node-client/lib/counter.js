/**
 * Created by hetiu on 2017/6/13.
 */
const prom = require('prom-client');
const monitor = require('./monitor');

module.exports = (name, labelNames = []) => new Counter(name, labelNames);

class Counter {
    /**
     * Counter
     * @param {string} name - Name of the metric
     */
    constructor(name, labelNames) {
        if (monitor.isEnable) {
            this.metric = prom.register.getSingleMetric(name) ||
                new prom.Counter({
                    name,
                    labelNames,
                    help: 'nothing',
                });
        }
    }

    /**
     * Increment counter
     * @param {object} labels - What label you want to be incremented
     * @param {Number} value - Value to increment, if omitted increment with 1
     * @param {(Number|Date)} timestamp - Timestamp to set the counter to
     * @returns {void}
     */
    inc(labels, value, timestamp) {
        if (monitor.isEnable) {
            this.metric.inc(labels, value, timestamp);
        }
    }
}

